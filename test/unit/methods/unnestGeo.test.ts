import { assertEquals } from "@std/assert";
import SimpleDB from "../../../src/class/SimpleDB.ts";

Deno.test("should unnest geometries", async () => {
  const sdb = new SimpleDB();
  const table = sdb.newTable();
  await table.loadGeoData("test/geodata/files/earthquake.geojson");
  await table.unnestGeo();

  const data = await table.getGeoData();

  assertEquals(data, {
    type: "FeatureCollection",
    features: [
      {
        type: "Feature",
        properties: { value: 1.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [152.216762, 30.516197],
            [152.117046, 30.463968],
            [151.899755, 30.233111],
            [151.895053, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [152.216762, 32.388814],
            [152.117046, 32.312719],
            [151.738702, 31.763037],
            [151.341268, 31.264148],
            [150.914525, 30.798519],
            [150.360888, 30.26637],
            [150.303031, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 44.982045],
            [134.817874, 45.000222],
            [134.880717, 45.066741],
            [134.880717, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [151.17911, 45.1],
            [151.238481, 44.966963],
            [151.682954, 44.601111],
            [152.150285, 44.147432],
            [152.216762, 44.133468],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 44.61197],
            [134.778318, 44.63437],
            [134.733333, 44.655279],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [152.216762, 35.361779],
            [152.150285, 35.31318],
            [152.117046, 35.246661],
            [151.316733, 33.426],
            [150.935855, 32.760815],
            [150.614581, 32.295185],
            [150.182793, 31.763037],
            [149.6574, 31.220676],
            [149.180175, 30.798519],
            [148.461872, 30.26637],
            [148.380293, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [136.458731, 30.166593],
            [136.424092, 30.233111],
            [135.513705, 30.765259],
            [134.899526, 31.211621],
            [134.733333, 31.272464],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 42.519863],
            [134.833049, 42.561225],
            [135.134005, 43.004667],
            [135.431341, 43.373385],
            [135.996395, 43.933981],
            [136.727641, 44.490034],
            [137.622093, 45.000222],
            [137.655331, 45.033481],
            [137.665326, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [148.353237, 45.1],
            [148.403819, 45.000222],
            [148.859677, 44.780254],
            [149.564375, 44.368296],
            [150.255693, 43.846216],
            [150.687109, 43.437037],
            [150.95758, 43.137704],
            [151.306678, 42.672074],
            [151.469926, 42.406],
            [151.636167, 42.106667],
            [151.820441, 41.674296],
            [151.970372, 41.208667],
            [152.054759, 40.809556],
            [152.131698, 40.011333],
            [152.077177, 39.412667],
            [151.994927, 38.947037],
            [151.755528, 38.182074],
            [150.787508, 35.999756],
            [149.92735, 33.958148],
            [149.577899, 33.326222],
            [149.291777, 32.910669],
            [148.926154, 32.462719],
            [148.494054, 32.021155],
            [148.128431, 31.699508],
            [147.530139, 31.25682],
            [146.665939, 30.758416],
            [146.034409, 30.483796],
            [145.288134, 30.233111],
            [145.221657, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.70766, 30.166593],
            [140.698405, 30.199852],
            [140.641183, 30.233111],
            [138.422802, 30.834452],
            [137.890987, 31.021533],
            [137.259456, 31.298419],
            [136.328779, 31.84684],
            [135.763725, 32.269366],
            [134.939331, 32.99363],
            [134.833049, 33.066684],
            [134.733333, 33.08889],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 36.024754],
            [134.866287, 36.113779],
            [134.940498, 36.319556],
            [135.049666, 37.350593],
            [135.860221, 40.975852],
            [135.996395, 41.399366],
            [136.12794, 41.707556],
            [136.395256, 42.173978],
            [136.693033, 42.572296],
            [137.069946, 42.971407],
            [137.359171, 43.227543],
            [137.857748, 43.592965],
            [138.489279, 43.956012],
            [139.021094, 44.189412],
            [140.649779, 44.727893],
            [140.815971, 44.81221],
            [141.015402, 44.961714],
            [141.063463, 45.033481],
            [141.065196, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [142.948436, 45.1],
            [142.976471, 45.029446],
            [143.076186, 44.947589],
            [143.475047, 44.821223],
            [145.303163, 44.585262],
            [146.366793, 44.403385],
            [147.264231, 44.080053],
            [147.796047, 43.848163],
            [148.494054, 43.444092],
            [148.959393, 43.097884],
            [149.213779, 42.87163],
            [149.535974, 42.539037],
            [149.774643, 42.239704],
            [149.93694, 42.006889],
            [150.180164, 41.574519],
            [150.43626, 40.876074],
            [150.552501, 40.14437],
            [150.55082, 39.712],
            [150.435011, 38.980296],
            [150.27243, 38.481407],
            [149.504099, 36.685407],
            [148.5573, 34.357259],
            [148.284164, 33.85837],
            [148.057368, 33.525778],
            [147.668479, 33.060148],
            [147.164516, 32.584012],
            [146.632701, 32.188771],
            [145.934693, 31.789858],
            [145.303163, 31.526408],
            [144.538678, 31.29833],
            [143.84067, 31.174475],
            [143.275617, 31.118527],
            [142.843517, 31.10888],
            [142.079032, 31.176684],
            [141.347786, 31.309468],
            [139.187287, 31.889576],
            [138.622233, 32.072245],
            [137.990702, 32.339935],
            [137.625079, 32.541325],
            [137.26601, 32.760815],
            [136.555793, 33.259704],
            [136.395256, 33.344453],
            [135.830202, 33.534154],
            [135.464579, 33.587308],
            [135.371481, 33.692074],
            [135.423404, 33.924889],
            [135.388515, 34.024667],
            [135.265149, 34.039536],
            [135.098956, 33.952451],
            [134.866287, 34.024161],
            [134.733333, 34.034238],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 4.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [142.356832, 45.1],
            [142.34494, 44.93112],
            [142.245225, 44.870634],
            [142.178748, 44.748371],
            [142.079032, 44.700916],
            [142.079032, 44.655331],
            [142.378178, 44.505819],
            [142.517154, 44.368296],
            [142.550708, 44.235259],
            [142.509781, 44.035704],
            [142.639944, 43.902667],
            [143.042948, 43.749261],
            [143.275617, 43.729206],
            [143.541619, 43.836148],
            [143.651365, 43.935926],
            [143.758483, 44.102222],
            [143.820079, 44.135481],
            [143.973624, 44.174836],
            [144.173055, 44.174541],
            [144.438963, 44.105355],
            [144.695488, 44.002444],
            [144.93754, 43.835925],
            [145.170209, 43.773277],
            [145.369639, 43.665262],
            [145.496471, 43.536815],
            [145.544591, 43.370519],
            [145.668786, 43.226917],
            [146.267078, 43.163678],
            [146.660564, 43.037926],
            [147.268925, 42.738593],
            [147.862524, 42.326153],
            [148.354614, 41.840593],
            [148.603238, 41.508],
            [148.795035, 41.175407],
            [149.01716, 40.576741],
            [149.114746, 39.878296],
            [149.056261, 39.346148],
            [148.899552, 38.780741],
            [147.264657, 34.689852],
            [147.019841, 34.257481],
            [146.765655, 33.916631],
            [146.206571, 33.359481],
            [145.802563, 33.060148],
            [145.279796, 32.760815],
            [144.837824, 32.573633],
            [144.27277, 32.395906],
            [143.84067, 32.308981],
            [143.142663, 32.232347],
            [142.710563, 32.237947],
            [142.045794, 32.316905],
            [141.646932, 32.399741],
            [140.350633, 32.742731],
            [139.719102, 32.859266],
            [138.68871, 33.292192],
            [137.676401, 33.89163],
            [137.34487, 34.057926],
            [137.159741, 34.112252],
            [136.652185, 34.157704],
            [136.451024, 34.290741],
            [136.428989, 34.324],
            [136.447222, 34.390519],
            [136.428495, 34.439122],
            [136.380319, 34.523556],
            [136.295541, 34.598291],
            [136.162587, 34.639799],
            [136.029633, 34.613355],
            [135.863441, 34.457021],
            [135.66401, 34.409672],
            [135.564295, 34.438048],
            [135.464579, 34.425306],
            [135.36729, 34.490296],
            [135.336096, 34.556815],
            [135.417813, 34.689852],
            [135.564295, 34.736194],
            [135.66401, 34.833089],
            [135.776533, 34.889407],
            [135.941273, 35.288519],
            [136.062872, 35.451814],
            [136.195825, 35.498085],
            [136.428495, 35.486797],
            [136.543413, 35.554593],
            [136.753352, 35.787407],
            [136.834986, 36.053481],
            [136.96824, 36.219778],
            [136.927071, 36.393486],
            [136.794118, 36.457929],
            [136.392205, 36.785185],
            [136.310646, 36.918222],
            [136.284622, 37.084519],
            [136.352163, 37.417111],
            [136.622477, 38.082296],
            [136.717851, 38.38163],
            [137.322817, 40.776296],
            [137.512702, 41.275185],
            [137.68344, 41.574519],
            [137.975807, 41.97363],
            [138.289848, 42.301017],
            [138.655742, 42.605556],
            [138.921379, 42.789361],
            [139.353479, 43.032229],
            [140.018248, 43.285018],
            [140.18444, 43.331123],
            [140.516825, 43.281832],
            [140.531867, 43.403778],
            [140.57239, 43.470296],
            [141.015402, 43.769486],
            [141.148355, 43.902523],
            [141.347786, 44.174618],
            [141.527452, 44.567852],
            [141.581447, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 4.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.308855, 33.256795],
            [142.943232, 33.230508],
            [142.278463, 33.301919],
            [140.317394, 33.806024],
            [139.386717, 33.937723],
            [139.169629, 34.024667],
            [138.588994, 34.344458],
            [137.791271, 34.538281],
            [137.39241, 34.606413],
            [137.060025, 34.627865],
            [136.741011, 34.78963],
            [136.566632, 34.822889],
            [136.494972, 34.892321],
            [136.47983, 34.955926],
            [136.594687, 35.143957],
            [136.727641, 35.210909],
            [136.893833, 35.183357],
            [137.126502, 35.095285],
            [137.39241, 34.879621],
            [137.532165, 34.889407],
            [137.594607, 34.989185],
            [137.51247, 35.188741],
            [137.39241, 35.343287],
            [137.373863, 35.454815],
            [137.548346, 35.720889],
            [137.560692, 35.787407],
            [137.658318, 35.948585],
            [137.762337, 36.020222],
            [137.82451, 36.117012],
            [137.857748, 36.353221],
            [138.021036, 36.58563],
            [137.990702, 36.591728],
            [137.882247, 36.851704],
            [137.758033, 36.9761],
            [137.568913, 37.018],
            [137.292694, 37.147834],
            [137.242846, 37.117778],
            [137.277035, 37.018],
            [137.372085, 36.918222],
            [137.393771, 36.785185],
            [137.323246, 36.685407],
            [137.2577, 36.652148],
            [137.159741, 36.637844],
            [137.093264, 36.660677],
            [136.925294, 36.785185],
            [136.853256, 36.918222],
            [136.822361, 36.984741],
            [136.842953, 37.151037],
            [136.927071, 37.284414],
            [137.060025, 37.341472],
            [137.131821, 37.45037],
            [137.226218, 37.519374],
            [137.325933, 37.586184],
            [137.558602, 37.625185],
            [137.625079, 37.660487],
            [137.76221, 37.816222],
            [138.173582, 38.913778],
            [138.684671, 40.709778],
            [138.943632, 41.208667],
            [139.373891, 41.807333],
            [139.467575, 42.073407],
            [139.619386, 42.202962],
            [140.084725, 42.208706],
            [140.217679, 42.254823],
            [140.310208, 42.306222],
            [140.322984, 42.339481],
            [140.417109, 42.375861],
            [140.649779, 42.399332],
            [140.849209, 42.469065],
            [141.074512, 42.605556],
            [141.303209, 42.87163],
            [141.311615, 42.938148],
            [141.253534, 43.170963],
            [141.281309, 43.255043],
            [141.414263, 43.356543],
            [141.613694, 43.409684],
            [141.680171, 43.451678],
            [141.76095, 43.536815],
            [141.779886, 43.752935],
            [141.91284, 43.863559],
            [142.011711, 43.836148],
            [142.108439, 43.703111],
            [142.107809, 43.570074],
            [142.043458, 43.437037],
            [142.052652, 43.337259],
            [142.093514, 43.270741],
            [142.178748, 43.191442],
            [142.34494, 43.152514],
            [142.511132, 43.024484],
            [142.610848, 42.994343],
            [142.703907, 43.104444],
            [142.843517, 43.199447],
            [143.475047, 43.358441],
            [143.774194, 43.406012],
            [144.006863, 43.562325],
            [144.07334, 43.580568],
            [144.339247, 43.488449],
            [144.671632, 43.488319],
            [144.771347, 43.458341],
            [144.858103, 43.370519],
            [144.887779, 43.270741],
            [144.581206, 42.87163],
            [144.549908, 42.771852],
            [144.615884, 42.672074],
            [144.810619, 42.539037],
            [145.602309, 42.311744],
            [146.200601, 42.080315],
            [146.599462, 41.850542],
            [146.898608, 41.626579],
            [147.223052, 41.308444],
            [147.446256, 41.009111],
            [147.663715, 40.576741],
            [147.771912, 40.17763],
            [147.807084, 39.745259],
            [147.736408, 39.27963],
            [147.649677, 39.013556],
            [146.898608, 37.104916],
            [146.199639, 35.222],
            [145.94557, 34.723111],
            [145.719653, 34.423778],
            [145.402878, 34.107494],
            [145.070493, 33.855475],
            [144.70487, 33.64265],
            [144.372486, 33.497884],
            [143.973624, 33.368724],
            [143.308855, 33.256795],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.175901, 33.75787],
            [142.943232, 33.742985],
            [142.411417, 33.801375],
            [140.516825, 34.281204],
            [139.386717, 34.326492],
            [139.263713, 34.357259],
            [139.087571, 34.512465],
            [138.987856, 34.704961],
            [138.921379, 34.773534],
            [138.821664, 34.808289],
            [138.601319, 34.822889],
            [138.485418, 34.922667],
            [138.418831, 35.055704],
            [138.389564, 35.312213],
            [138.338745, 35.421556],
            [138.272357, 35.754148],
            [138.23044, 35.820667],
            [138.090417, 35.909039],
            [138.063844, 35.953704],
            [138.094524, 36.086741],
            [138.289848, 36.337909],
            [138.413535, 36.652148],
            [138.380296, 36.718667],
            [138.25661, 36.75812],
            [138.170744, 36.851704],
            [138.187635, 36.918222],
            [138.162675, 37.051259],
            [138.170684, 37.284074],
            [138.323087, 37.560913],
            [138.397842, 37.782963],
            [138.388434, 37.949259],
            [138.427534, 38.115556],
            [138.679448, 38.481407],
            [138.788312, 38.714222],
            [139.243161, 40.17763],
            [139.453194, 40.687646],
            [139.886068, 41.441481],
            [140.018248, 41.505435],
            [140.18444, 41.477025],
            [140.284156, 41.539817],
            [140.550063, 41.791192],
            [140.716256, 41.870263],
            [140.782732, 41.853434],
            [140.882448, 41.773579],
            [141.04864, 41.815334],
            [141.214832, 41.985853],
            [141.47568, 42.173185],
            [141.559504, 42.372741],
            [141.527156, 42.539037],
            [141.551157, 42.638815],
            [141.524667, 42.705333],
            [141.545214, 42.904889],
            [141.510755, 43.071185],
            [141.574157, 43.204222],
            [141.646932, 43.249678],
            [141.779886, 43.191943],
            [141.91284, 43.012755],
            [142.045794, 42.888452],
            [142.283775, 42.771852],
            [142.530674, 42.406],
            [142.662024, 42.306222],
            [143.076186, 42.095946],
            [143.175901, 42.078391],
            [143.475047, 42.170105],
            [143.873909, 42.073698],
            [144.837824, 41.962001],
            [145.170209, 41.892631],
            [145.535832, 41.77571],
            [146.034409, 41.535454],
            [146.43327, 41.251685],
            [146.748751, 40.909333],
            [146.960028, 40.576741],
            [147.111311, 40.111111],
            [147.147959, 39.778519],
            [147.090047, 39.379407],
            [147.015784, 39.146593],
            [146.300316, 37.290291],
            [145.596806, 35.355037],
            [145.392503, 34.955926],
            [145.203447, 34.706036],
            [144.953083, 34.457037],
            [144.671632, 34.245413],
            [144.372486, 34.072945],
            [143.774194, 33.8525],
            [143.175901, 33.75787],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [139.106436, 36.918222],
            [139.253763, 36.992999],
            [139.320535, 37.117778],
            [139.253763, 37.193844],
            [139.154048, 37.251662],
            [139.087571, 37.24742],
            [138.954617, 37.176961],
            [138.86465, 37.051259],
            [138.87896, 36.951481],
            [138.928622, 36.918222],
            [139.054333, 36.894409],
            [139.106436, 36.918222],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [138.458037, 36.718667],
            [138.45604, 36.767987],
            [138.401128, 36.718667],
            [138.458037, 36.718667],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.076186, 34.155695],
            [142.810278, 34.160893],
            [142.311701, 34.238224],
            [141.248071, 34.538499],
            [140.749494, 34.650486],
            [140.317394, 34.651746],
            [140.018248, 34.54253],
            [139.818817, 34.541325],
            [139.486433, 34.663562],
            [139.260602, 34.78963],
            [138.924828, 35.155481],
            [138.68871, 35.141582],
            [138.588994, 35.185385],
            [138.55027, 35.255259],
            [138.57095, 35.521333],
            [138.622233, 35.572389],
            [138.946758, 35.68763],
            [139.187287, 35.687297],
            [139.248842, 35.754148],
            [139.23313, 35.853926],
            [139.099633, 36.053481],
            [138.954617, 36.173788],
            [138.8017, 36.352815],
            [138.808146, 36.485852],
            [138.873892, 36.58563],
            [138.987856, 36.677232],
            [139.287002, 36.717518],
            [139.55291, 36.911588],
            [139.62278, 36.984741],
            [139.645386, 37.051259],
            [139.651436, 37.117778],
            [139.386717, 37.592738],
            [139.32024, 37.65472],
            [139.220525, 37.653639],
            [139.154048, 37.570091],
            [138.920131, 37.383852],
            [138.723934, 37.284074],
            [138.659429, 37.317333],
            [138.646624, 37.417111],
            [138.755668, 37.616667],
            [138.841604, 37.916],
            [139.166891, 38.281852],
            [139.252774, 38.448148],
            [139.391643, 39.046815],
            [139.722066, 39.745259],
            [139.829985, 40.077852],
            [139.945392, 40.210889],
            [140.046111, 40.277407],
            [140.337989, 40.310667],
            [140.41547, 40.377185],
            [140.42658, 40.443704],
            [140.384152, 40.576741],
            [140.251697, 40.743037],
            [140.278161, 40.909333],
            [140.330855, 40.975852],
            [140.483586, 41.04849],
            [140.849209, 41.058203],
            [140.925529, 41.108889],
            [141.04196, 41.308444],
            [141.181594, 41.437816],
            [141.414263, 41.438711],
            [141.513978, 41.479392],
            [141.680171, 41.608209],
            [141.91284, 41.67364],
            [142.477894, 41.725447],
            [144.339247, 41.606236],
            [144.93754, 41.521078],
            [145.303163, 41.410674],
            [145.535832, 41.311653],
            [145.801739, 41.157714],
            [146.04137, 40.975852],
            [146.207562, 40.809556],
            [146.473436, 40.410444],
            [146.591361, 40.044593],
            [146.623215, 39.778519],
            [146.566233, 39.412667],
            [145.768501, 37.282689],
            [145.129171, 35.488074],
            [144.962942, 35.155481],
            [144.786649, 34.922667],
            [144.605155, 34.742655],
            [144.357986, 34.556815],
            [144.106578, 34.413563],
            [143.64124, 34.24242],
            [143.076186, 34.155695],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.52297, 39.712],
            [140.584024, 39.811778],
            [140.550063, 39.89456],
            [140.383871, 40.028791],
            [140.317394, 40.034494],
            [140.218809, 39.878296],
            [140.243392, 39.811778],
            [140.350633, 39.70604],
            [140.52297, 39.712],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 6.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [142.976471, 34.522927],
            [142.444655, 34.595768],
            [141.347786, 34.911581],
            [140.882448, 35.014967],
            [140.417109, 35.006787],
            [140.084725, 34.910599],
            [139.985009, 34.858842],
            [139.685863, 34.823312],
            [139.386717, 34.906315],
            [139.071398, 35.188741],
            [139.06722, 35.321778],
            [139.353479, 35.485695],
            [139.453194, 35.597179],
            [139.468429, 35.65437],
            [139.437347, 35.787407],
            [139.37801, 35.887185],
            [139.169414, 36.12],
            [139.042863, 36.219778],
            [139.002623, 36.352815],
            [139.12081, 36.468336],
            [139.287002, 36.480736],
            [139.424129, 36.452593],
            [139.55291, 36.548797],
            [139.597113, 36.751926],
            [139.77966, 36.984741],
            [139.817077, 37.084519],
            [139.798174, 37.383852],
            [139.74426, 37.516889],
            [139.920947, 37.816222],
            [139.937693, 37.916],
            [140.062401, 38.148815],
            [140.070345, 38.248593],
            [139.985009, 38.462953],
            [139.985009, 38.56021],
            [139.951324, 38.614444],
            [139.852007, 38.647704],
            [139.765195, 38.747481],
            [139.727789, 38.814],
            [139.716691, 38.913778],
            [139.790642, 39.046815],
            [139.918533, 39.142791],
            [140.018248, 39.139739],
            [140.045306, 39.113333],
            [140.09202, 38.947037],
            [140.18444, 38.84383],
            [140.460086, 38.980296],
            [140.49983, 39.080074],
            [140.503586, 39.213111],
            [140.48101, 39.24637],
            [140.383871, 39.278055],
            [140.291868, 39.412667],
            [140.350633, 39.549734],
            [140.483586, 39.568941],
            [140.550063, 39.486411],
            [140.683017, 39.445883],
            [140.749494, 39.459099],
            [140.815971, 39.526171],
            [140.841, 39.645481],
            [140.792068, 39.845037],
            [140.80018, 39.911556],
            [140.860654, 40.077852],
            [140.939592, 40.17763],
            [140.817854, 40.476963],
            [140.843152, 40.61],
            [141.015402, 40.789505],
            [141.248071, 40.916448],
            [141.414263, 40.964258],
            [141.695393, 41.175407],
            [142.178748, 41.268697],
            [142.710563, 41.29248],
            [144.27277, 41.234332],
            [144.871063, 41.145299],
            [145.239768, 41.009111],
            [145.469355, 40.881472],
            [145.690054, 40.709778],
            [145.868216, 40.514721],
            [146.016311, 40.277407],
            [146.100748, 40.044593],
            [146.13837, 39.778519],
            [146.100133, 39.512444],
            [144.688351, 35.587852],
            [144.553897, 35.321778],
            [144.27277, 34.999568],
            [143.873909, 34.735615],
            [143.508286, 34.599734],
            [142.976471, 34.522927],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 6.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.109424, 34.885153],
            [142.943232, 34.868587],
            [142.544371, 34.928726],
            [141.314548, 35.2979],
            [140.948925, 35.383483],
            [140.683017, 35.383186],
            [140.350633, 35.237359],
            [139.985009, 35.172741],
            [139.885294, 35.230602],
            [139.707153, 35.421556],
            [139.641902, 35.554593],
            [139.619386, 35.75171],
            [139.434111, 36.053481],
            [139.420228, 36.12],
            [139.294487, 36.253037],
            [139.299962, 36.286296],
            [139.386717, 36.345676],
            [139.55291, 36.35257],
            [139.619386, 36.394037],
            [139.6829, 36.485852],
            [139.737002, 36.718667],
            [139.865425, 36.918222],
            [139.938115, 37.117778],
            [139.951315, 37.250815],
            [139.918533, 37.525339],
            [139.952462, 37.583407],
            [140.101153, 37.683185],
            [140.229306, 37.882741],
            [140.350633, 37.986468],
            [140.383871, 38.064759],
            [140.405539, 38.182074],
            [140.324086, 38.448148],
            [140.340255, 38.547926],
            [140.419071, 38.680963],
            [140.717468, 38.947037],
            [140.997411, 39.412667],
            [141.160722, 39.578963],
            [141.162439, 39.678741],
            [141.104781, 39.778519],
            [141.043252, 39.811778],
            [141.04864, 39.891215],
            [141.148355, 39.948209],
            [141.314548, 39.85371],
            [141.347786, 39.806649],
            [141.447502, 39.839876],
            [141.513978, 39.833763],
            [141.66213, 39.911556],
            [141.847904, 40.277407],
            [141.852028, 40.410444],
            [141.79724, 40.61],
            [141.879602, 40.756227],
            [141.979317, 40.816705],
            [142.178748, 40.86412],
            [142.943232, 40.929737],
            [144.206293, 40.895128],
            [144.70487, 40.826785],
            [145.004016, 40.716555],
            [145.170209, 40.624126],
            [145.469355, 40.358842],
            [145.601128, 40.14437],
            [145.663673, 39.978074],
            [145.691761, 39.778519],
            [145.65638, 39.545704],
            [144.904301, 37.479661],
            [144.28666, 35.68763],
            [144.203134, 35.521333],
            [144.05585, 35.321778],
            [143.807432, 35.11294],
            [143.475047, 34.95728],
            [143.109424, 34.885153],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.042948, 35.188411],
            [142.943232, 35.179946],
            [142.644086, 35.226629],
            [140.815971, 35.834881],
            [140.550063, 35.859573],
            [140.250917, 35.81277],
            [140.117963, 35.856867],
            [139.951771, 35.969018],
            [139.852056, 36.004946],
            [139.776788, 36.186519],
            [139.802147, 36.419333],
            [139.893366, 36.785185],
            [140.058657, 37.151037],
            [140.040578, 37.317333],
            [140.060738, 37.417111],
            [140.12863, 37.516889],
            [140.305008, 37.649926],
            [140.488602, 37.849481],
            [140.592092, 38.281852],
            [140.632097, 38.647704],
            [140.739214, 38.814],
            [140.990135, 39.080074],
            [141.04864, 39.231685],
            [141.181594, 39.280866],
            [141.414202, 39.046815],
            [141.48074, 39.030298],
            [141.646932, 39.069947],
            [141.946078, 39.350927],
            [142.023561, 39.512444],
            [142.034556, 39.612222],
            [141.909689, 39.911556],
            [141.914279, 40.044593],
            [142.079032, 40.275452],
            [142.278463, 40.45696],
            [142.544371, 40.547308],
            [143.175901, 40.606046],
            [144.173055, 40.588495],
            [144.571917, 40.534758],
            [144.904301, 40.389814],
            [145.136848, 40.17763],
            [145.269802, 39.911556],
            [145.286888, 39.778519],
            [145.268221, 39.612222],
            [143.873909, 35.676396],
            [143.740955, 35.495802],
            [143.568604, 35.355037],
            [143.342094, 35.245452],
            [143.042948, 35.188411],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.142663, 35.479221],
            [142.976471, 35.456489],
            [142.743801, 35.488472],
            [141.148355, 36.054676],
            [140.948925, 36.096773],
            [140.583302, 36.092761],
            [140.510897, 36.153259],
            [140.450348, 36.271385],
            [140.418697, 36.286296],
            [140.354496, 36.452593],
            [140.360465, 36.519111],
            [140.649779, 36.770306],
            [140.733787, 36.984741],
            [140.892874, 37.184296],
            [140.935011, 37.317333],
            [140.874552, 37.583407],
            [140.873582, 37.716444],
            [140.751232, 37.916],
            [140.693413, 38.082296],
            [140.808331, 38.614444],
            [140.863389, 38.714222],
            [141.015402, 38.867145],
            [141.115117, 38.895341],
            [141.248071, 38.817963],
            [141.347786, 38.640142],
            [141.447502, 38.62662],
            [141.563834, 38.780741],
            [141.83655, 38.980296],
            [142.201888, 39.379407],
            [142.271589, 39.545704],
            [142.285627, 39.944815],
            [142.379596, 40.077852],
            [142.544371, 40.186928],
            [142.810278, 40.256492],
            [143.508286, 40.319721],
            [144.139817, 40.316372],
            [144.50544, 40.258719],
            [144.672962, 40.17763],
            [144.871317, 39.978074],
            [144.919115, 39.845037],
            [144.905051, 39.612222],
            [144.239532, 37.760105],
            [143.600712, 35.853926],
            [143.422822, 35.621111],
            [143.33103, 35.554593],
            [143.142663, 35.479221],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.383871, 37.112449],
            [140.284156, 37.114907],
            [140.208322, 37.217556],
            [140.215459, 37.317333],
            [140.284156, 37.390975],
            [140.417109, 37.398796],
            [140.504185, 37.284074],
            [140.465711, 37.184296],
            [140.383871, 37.112449],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.18444, 36.441507],
            [139.989383, 36.55237],
            [139.97774, 36.618889],
            [140.018248, 36.721327],
            [140.151202, 36.739761],
            [140.219139, 36.685407],
            [140.241341, 36.55237],
            [140.293799, 36.485852],
            [140.18444, 36.441507],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 8.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.076186, 35.740926],
            [142.843517, 35.740875],
            [142.710563, 35.783601],
            [142.295063, 35.953704],
            [142.050327, 36.086741],
            [141.920726, 36.219778],
            [141.893046, 36.286296],
            [141.90991, 36.419333],
            [142.295323, 37.217556],
            [142.592237, 37.982519],
            [142.926363, 39.013556],
            [143.079055, 39.712],
            [143.122369, 39.811778],
            [143.255732, 39.944815],
            [143.475047, 39.995193],
            [144.139817, 40.053684],
            [144.372486, 40.01373],
            [144.540613, 39.878296],
            [144.578776, 39.778519],
            [144.566268, 39.645481],
            [143.886624, 37.749704],
            [143.313961, 35.986963],
            [143.228629, 35.853926],
            [143.076186, 35.740926],
          ],
        },
      },
    ],
  });

  await sdb.done();
});
Deno.test("should unnest geometries from a specific column", async () => {
  const sdb = new SimpleDB();
  const table = sdb.newTable();
  await table.loadGeoData("test/geodata/files/earthquake.geojson");
  await table.unnestGeo("geom");

  const data = await table.getGeoData();

  assertEquals(data, {
    type: "FeatureCollection",
    features: [
      {
        type: "Feature",
        properties: { value: 1.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [152.216762, 30.516197],
            [152.117046, 30.463968],
            [151.899755, 30.233111],
            [151.895053, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [152.216762, 32.388814],
            [152.117046, 32.312719],
            [151.738702, 31.763037],
            [151.341268, 31.264148],
            [150.914525, 30.798519],
            [150.360888, 30.26637],
            [150.303031, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 44.982045],
            [134.817874, 45.000222],
            [134.880717, 45.066741],
            [134.880717, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [151.17911, 45.1],
            [151.238481, 44.966963],
            [151.682954, 44.601111],
            [152.150285, 44.147432],
            [152.216762, 44.133468],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 44.61197],
            [134.778318, 44.63437],
            [134.733333, 44.655279],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [152.216762, 35.361779],
            [152.150285, 35.31318],
            [152.117046, 35.246661],
            [151.316733, 33.426],
            [150.935855, 32.760815],
            [150.614581, 32.295185],
            [150.182793, 31.763037],
            [149.6574, 31.220676],
            [149.180175, 30.798519],
            [148.461872, 30.26637],
            [148.380293, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 2.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [136.458731, 30.166593],
            [136.424092, 30.233111],
            [135.513705, 30.765259],
            [134.899526, 31.211621],
            [134.733333, 31.272464],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 42.519863],
            [134.833049, 42.561225],
            [135.134005, 43.004667],
            [135.431341, 43.373385],
            [135.996395, 43.933981],
            [136.727641, 44.490034],
            [137.622093, 45.000222],
            [137.655331, 45.033481],
            [137.665326, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [148.353237, 45.1],
            [148.403819, 45.000222],
            [148.859677, 44.780254],
            [149.564375, 44.368296],
            [150.255693, 43.846216],
            [150.687109, 43.437037],
            [150.95758, 43.137704],
            [151.306678, 42.672074],
            [151.469926, 42.406],
            [151.636167, 42.106667],
            [151.820441, 41.674296],
            [151.970372, 41.208667],
            [152.054759, 40.809556],
            [152.131698, 40.011333],
            [152.077177, 39.412667],
            [151.994927, 38.947037],
            [151.755528, 38.182074],
            [150.787508, 35.999756],
            [149.92735, 33.958148],
            [149.577899, 33.326222],
            [149.291777, 32.910669],
            [148.926154, 32.462719],
            [148.494054, 32.021155],
            [148.128431, 31.699508],
            [147.530139, 31.25682],
            [146.665939, 30.758416],
            [146.034409, 30.483796],
            [145.288134, 30.233111],
            [145.221657, 30.166593],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.70766, 30.166593],
            [140.698405, 30.199852],
            [140.641183, 30.233111],
            [138.422802, 30.834452],
            [137.890987, 31.021533],
            [137.259456, 31.298419],
            [136.328779, 31.84684],
            [135.763725, 32.269366],
            [134.939331, 32.99363],
            [134.833049, 33.066684],
            [134.733333, 33.08889],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [134.733333, 36.024754],
            [134.866287, 36.113779],
            [134.940498, 36.319556],
            [135.049666, 37.350593],
            [135.860221, 40.975852],
            [135.996395, 41.399366],
            [136.12794, 41.707556],
            [136.395256, 42.173978],
            [136.693033, 42.572296],
            [137.069946, 42.971407],
            [137.359171, 43.227543],
            [137.857748, 43.592965],
            [138.489279, 43.956012],
            [139.021094, 44.189412],
            [140.649779, 44.727893],
            [140.815971, 44.81221],
            [141.015402, 44.961714],
            [141.063463, 45.033481],
            [141.065196, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 3.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [142.948436, 45.1],
            [142.976471, 45.029446],
            [143.076186, 44.947589],
            [143.475047, 44.821223],
            [145.303163, 44.585262],
            [146.366793, 44.403385],
            [147.264231, 44.080053],
            [147.796047, 43.848163],
            [148.494054, 43.444092],
            [148.959393, 43.097884],
            [149.213779, 42.87163],
            [149.535974, 42.539037],
            [149.774643, 42.239704],
            [149.93694, 42.006889],
            [150.180164, 41.574519],
            [150.43626, 40.876074],
            [150.552501, 40.14437],
            [150.55082, 39.712],
            [150.435011, 38.980296],
            [150.27243, 38.481407],
            [149.504099, 36.685407],
            [148.5573, 34.357259],
            [148.284164, 33.85837],
            [148.057368, 33.525778],
            [147.668479, 33.060148],
            [147.164516, 32.584012],
            [146.632701, 32.188771],
            [145.934693, 31.789858],
            [145.303163, 31.526408],
            [144.538678, 31.29833],
            [143.84067, 31.174475],
            [143.275617, 31.118527],
            [142.843517, 31.10888],
            [142.079032, 31.176684],
            [141.347786, 31.309468],
            [139.187287, 31.889576],
            [138.622233, 32.072245],
            [137.990702, 32.339935],
            [137.625079, 32.541325],
            [137.26601, 32.760815],
            [136.555793, 33.259704],
            [136.395256, 33.344453],
            [135.830202, 33.534154],
            [135.464579, 33.587308],
            [135.371481, 33.692074],
            [135.423404, 33.924889],
            [135.388515, 34.024667],
            [135.265149, 34.039536],
            [135.098956, 33.952451],
            [134.866287, 34.024161],
            [134.733333, 34.034238],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 4.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [142.356832, 45.1],
            [142.34494, 44.93112],
            [142.245225, 44.870634],
            [142.178748, 44.748371],
            [142.079032, 44.700916],
            [142.079032, 44.655331],
            [142.378178, 44.505819],
            [142.517154, 44.368296],
            [142.550708, 44.235259],
            [142.509781, 44.035704],
            [142.639944, 43.902667],
            [143.042948, 43.749261],
            [143.275617, 43.729206],
            [143.541619, 43.836148],
            [143.651365, 43.935926],
            [143.758483, 44.102222],
            [143.820079, 44.135481],
            [143.973624, 44.174836],
            [144.173055, 44.174541],
            [144.438963, 44.105355],
            [144.695488, 44.002444],
            [144.93754, 43.835925],
            [145.170209, 43.773277],
            [145.369639, 43.665262],
            [145.496471, 43.536815],
            [145.544591, 43.370519],
            [145.668786, 43.226917],
            [146.267078, 43.163678],
            [146.660564, 43.037926],
            [147.268925, 42.738593],
            [147.862524, 42.326153],
            [148.354614, 41.840593],
            [148.603238, 41.508],
            [148.795035, 41.175407],
            [149.01716, 40.576741],
            [149.114746, 39.878296],
            [149.056261, 39.346148],
            [148.899552, 38.780741],
            [147.264657, 34.689852],
            [147.019841, 34.257481],
            [146.765655, 33.916631],
            [146.206571, 33.359481],
            [145.802563, 33.060148],
            [145.279796, 32.760815],
            [144.837824, 32.573633],
            [144.27277, 32.395906],
            [143.84067, 32.308981],
            [143.142663, 32.232347],
            [142.710563, 32.237947],
            [142.045794, 32.316905],
            [141.646932, 32.399741],
            [140.350633, 32.742731],
            [139.719102, 32.859266],
            [138.68871, 33.292192],
            [137.676401, 33.89163],
            [137.34487, 34.057926],
            [137.159741, 34.112252],
            [136.652185, 34.157704],
            [136.451024, 34.290741],
            [136.428989, 34.324],
            [136.447222, 34.390519],
            [136.428495, 34.439122],
            [136.380319, 34.523556],
            [136.295541, 34.598291],
            [136.162587, 34.639799],
            [136.029633, 34.613355],
            [135.863441, 34.457021],
            [135.66401, 34.409672],
            [135.564295, 34.438048],
            [135.464579, 34.425306],
            [135.36729, 34.490296],
            [135.336096, 34.556815],
            [135.417813, 34.689852],
            [135.564295, 34.736194],
            [135.66401, 34.833089],
            [135.776533, 34.889407],
            [135.941273, 35.288519],
            [136.062872, 35.451814],
            [136.195825, 35.498085],
            [136.428495, 35.486797],
            [136.543413, 35.554593],
            [136.753352, 35.787407],
            [136.834986, 36.053481],
            [136.96824, 36.219778],
            [136.927071, 36.393486],
            [136.794118, 36.457929],
            [136.392205, 36.785185],
            [136.310646, 36.918222],
            [136.284622, 37.084519],
            [136.352163, 37.417111],
            [136.622477, 38.082296],
            [136.717851, 38.38163],
            [137.322817, 40.776296],
            [137.512702, 41.275185],
            [137.68344, 41.574519],
            [137.975807, 41.97363],
            [138.289848, 42.301017],
            [138.655742, 42.605556],
            [138.921379, 42.789361],
            [139.353479, 43.032229],
            [140.018248, 43.285018],
            [140.18444, 43.331123],
            [140.516825, 43.281832],
            [140.531867, 43.403778],
            [140.57239, 43.470296],
            [141.015402, 43.769486],
            [141.148355, 43.902523],
            [141.347786, 44.174618],
            [141.527452, 44.567852],
            [141.581447, 45.1],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 4.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.308855, 33.256795],
            [142.943232, 33.230508],
            [142.278463, 33.301919],
            [140.317394, 33.806024],
            [139.386717, 33.937723],
            [139.169629, 34.024667],
            [138.588994, 34.344458],
            [137.791271, 34.538281],
            [137.39241, 34.606413],
            [137.060025, 34.627865],
            [136.741011, 34.78963],
            [136.566632, 34.822889],
            [136.494972, 34.892321],
            [136.47983, 34.955926],
            [136.594687, 35.143957],
            [136.727641, 35.210909],
            [136.893833, 35.183357],
            [137.126502, 35.095285],
            [137.39241, 34.879621],
            [137.532165, 34.889407],
            [137.594607, 34.989185],
            [137.51247, 35.188741],
            [137.39241, 35.343287],
            [137.373863, 35.454815],
            [137.548346, 35.720889],
            [137.560692, 35.787407],
            [137.658318, 35.948585],
            [137.762337, 36.020222],
            [137.82451, 36.117012],
            [137.857748, 36.353221],
            [138.021036, 36.58563],
            [137.990702, 36.591728],
            [137.882247, 36.851704],
            [137.758033, 36.9761],
            [137.568913, 37.018],
            [137.292694, 37.147834],
            [137.242846, 37.117778],
            [137.277035, 37.018],
            [137.372085, 36.918222],
            [137.393771, 36.785185],
            [137.323246, 36.685407],
            [137.2577, 36.652148],
            [137.159741, 36.637844],
            [137.093264, 36.660677],
            [136.925294, 36.785185],
            [136.853256, 36.918222],
            [136.822361, 36.984741],
            [136.842953, 37.151037],
            [136.927071, 37.284414],
            [137.060025, 37.341472],
            [137.131821, 37.45037],
            [137.226218, 37.519374],
            [137.325933, 37.586184],
            [137.558602, 37.625185],
            [137.625079, 37.660487],
            [137.76221, 37.816222],
            [138.173582, 38.913778],
            [138.684671, 40.709778],
            [138.943632, 41.208667],
            [139.373891, 41.807333],
            [139.467575, 42.073407],
            [139.619386, 42.202962],
            [140.084725, 42.208706],
            [140.217679, 42.254823],
            [140.310208, 42.306222],
            [140.322984, 42.339481],
            [140.417109, 42.375861],
            [140.649779, 42.399332],
            [140.849209, 42.469065],
            [141.074512, 42.605556],
            [141.303209, 42.87163],
            [141.311615, 42.938148],
            [141.253534, 43.170963],
            [141.281309, 43.255043],
            [141.414263, 43.356543],
            [141.613694, 43.409684],
            [141.680171, 43.451678],
            [141.76095, 43.536815],
            [141.779886, 43.752935],
            [141.91284, 43.863559],
            [142.011711, 43.836148],
            [142.108439, 43.703111],
            [142.107809, 43.570074],
            [142.043458, 43.437037],
            [142.052652, 43.337259],
            [142.093514, 43.270741],
            [142.178748, 43.191442],
            [142.34494, 43.152514],
            [142.511132, 43.024484],
            [142.610848, 42.994343],
            [142.703907, 43.104444],
            [142.843517, 43.199447],
            [143.475047, 43.358441],
            [143.774194, 43.406012],
            [144.006863, 43.562325],
            [144.07334, 43.580568],
            [144.339247, 43.488449],
            [144.671632, 43.488319],
            [144.771347, 43.458341],
            [144.858103, 43.370519],
            [144.887779, 43.270741],
            [144.581206, 42.87163],
            [144.549908, 42.771852],
            [144.615884, 42.672074],
            [144.810619, 42.539037],
            [145.602309, 42.311744],
            [146.200601, 42.080315],
            [146.599462, 41.850542],
            [146.898608, 41.626579],
            [147.223052, 41.308444],
            [147.446256, 41.009111],
            [147.663715, 40.576741],
            [147.771912, 40.17763],
            [147.807084, 39.745259],
            [147.736408, 39.27963],
            [147.649677, 39.013556],
            [146.898608, 37.104916],
            [146.199639, 35.222],
            [145.94557, 34.723111],
            [145.719653, 34.423778],
            [145.402878, 34.107494],
            [145.070493, 33.855475],
            [144.70487, 33.64265],
            [144.372486, 33.497884],
            [143.973624, 33.368724],
            [143.308855, 33.256795],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.175901, 33.75787],
            [142.943232, 33.742985],
            [142.411417, 33.801375],
            [140.516825, 34.281204],
            [139.386717, 34.326492],
            [139.263713, 34.357259],
            [139.087571, 34.512465],
            [138.987856, 34.704961],
            [138.921379, 34.773534],
            [138.821664, 34.808289],
            [138.601319, 34.822889],
            [138.485418, 34.922667],
            [138.418831, 35.055704],
            [138.389564, 35.312213],
            [138.338745, 35.421556],
            [138.272357, 35.754148],
            [138.23044, 35.820667],
            [138.090417, 35.909039],
            [138.063844, 35.953704],
            [138.094524, 36.086741],
            [138.289848, 36.337909],
            [138.413535, 36.652148],
            [138.380296, 36.718667],
            [138.25661, 36.75812],
            [138.170744, 36.851704],
            [138.187635, 36.918222],
            [138.162675, 37.051259],
            [138.170684, 37.284074],
            [138.323087, 37.560913],
            [138.397842, 37.782963],
            [138.388434, 37.949259],
            [138.427534, 38.115556],
            [138.679448, 38.481407],
            [138.788312, 38.714222],
            [139.243161, 40.17763],
            [139.453194, 40.687646],
            [139.886068, 41.441481],
            [140.018248, 41.505435],
            [140.18444, 41.477025],
            [140.284156, 41.539817],
            [140.550063, 41.791192],
            [140.716256, 41.870263],
            [140.782732, 41.853434],
            [140.882448, 41.773579],
            [141.04864, 41.815334],
            [141.214832, 41.985853],
            [141.47568, 42.173185],
            [141.559504, 42.372741],
            [141.527156, 42.539037],
            [141.551157, 42.638815],
            [141.524667, 42.705333],
            [141.545214, 42.904889],
            [141.510755, 43.071185],
            [141.574157, 43.204222],
            [141.646932, 43.249678],
            [141.779886, 43.191943],
            [141.91284, 43.012755],
            [142.045794, 42.888452],
            [142.283775, 42.771852],
            [142.530674, 42.406],
            [142.662024, 42.306222],
            [143.076186, 42.095946],
            [143.175901, 42.078391],
            [143.475047, 42.170105],
            [143.873909, 42.073698],
            [144.837824, 41.962001],
            [145.170209, 41.892631],
            [145.535832, 41.77571],
            [146.034409, 41.535454],
            [146.43327, 41.251685],
            [146.748751, 40.909333],
            [146.960028, 40.576741],
            [147.111311, 40.111111],
            [147.147959, 39.778519],
            [147.090047, 39.379407],
            [147.015784, 39.146593],
            [146.300316, 37.290291],
            [145.596806, 35.355037],
            [145.392503, 34.955926],
            [145.203447, 34.706036],
            [144.953083, 34.457037],
            [144.671632, 34.245413],
            [144.372486, 34.072945],
            [143.774194, 33.8525],
            [143.175901, 33.75787],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [139.106436, 36.918222],
            [139.253763, 36.992999],
            [139.320535, 37.117778],
            [139.253763, 37.193844],
            [139.154048, 37.251662],
            [139.087571, 37.24742],
            [138.954617, 37.176961],
            [138.86465, 37.051259],
            [138.87896, 36.951481],
            [138.928622, 36.918222],
            [139.054333, 36.894409],
            [139.106436, 36.918222],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [138.458037, 36.718667],
            [138.45604, 36.767987],
            [138.401128, 36.718667],
            [138.458037, 36.718667],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.076186, 34.155695],
            [142.810278, 34.160893],
            [142.311701, 34.238224],
            [141.248071, 34.538499],
            [140.749494, 34.650486],
            [140.317394, 34.651746],
            [140.018248, 34.54253],
            [139.818817, 34.541325],
            [139.486433, 34.663562],
            [139.260602, 34.78963],
            [138.924828, 35.155481],
            [138.68871, 35.141582],
            [138.588994, 35.185385],
            [138.55027, 35.255259],
            [138.57095, 35.521333],
            [138.622233, 35.572389],
            [138.946758, 35.68763],
            [139.187287, 35.687297],
            [139.248842, 35.754148],
            [139.23313, 35.853926],
            [139.099633, 36.053481],
            [138.954617, 36.173788],
            [138.8017, 36.352815],
            [138.808146, 36.485852],
            [138.873892, 36.58563],
            [138.987856, 36.677232],
            [139.287002, 36.717518],
            [139.55291, 36.911588],
            [139.62278, 36.984741],
            [139.645386, 37.051259],
            [139.651436, 37.117778],
            [139.386717, 37.592738],
            [139.32024, 37.65472],
            [139.220525, 37.653639],
            [139.154048, 37.570091],
            [138.920131, 37.383852],
            [138.723934, 37.284074],
            [138.659429, 37.317333],
            [138.646624, 37.417111],
            [138.755668, 37.616667],
            [138.841604, 37.916],
            [139.166891, 38.281852],
            [139.252774, 38.448148],
            [139.391643, 39.046815],
            [139.722066, 39.745259],
            [139.829985, 40.077852],
            [139.945392, 40.210889],
            [140.046111, 40.277407],
            [140.337989, 40.310667],
            [140.41547, 40.377185],
            [140.42658, 40.443704],
            [140.384152, 40.576741],
            [140.251697, 40.743037],
            [140.278161, 40.909333],
            [140.330855, 40.975852],
            [140.483586, 41.04849],
            [140.849209, 41.058203],
            [140.925529, 41.108889],
            [141.04196, 41.308444],
            [141.181594, 41.437816],
            [141.414263, 41.438711],
            [141.513978, 41.479392],
            [141.680171, 41.608209],
            [141.91284, 41.67364],
            [142.477894, 41.725447],
            [144.339247, 41.606236],
            [144.93754, 41.521078],
            [145.303163, 41.410674],
            [145.535832, 41.311653],
            [145.801739, 41.157714],
            [146.04137, 40.975852],
            [146.207562, 40.809556],
            [146.473436, 40.410444],
            [146.591361, 40.044593],
            [146.623215, 39.778519],
            [146.566233, 39.412667],
            [145.768501, 37.282689],
            [145.129171, 35.488074],
            [144.962942, 35.155481],
            [144.786649, 34.922667],
            [144.605155, 34.742655],
            [144.357986, 34.556815],
            [144.106578, 34.413563],
            [143.64124, 34.24242],
            [143.076186, 34.155695],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 5.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.52297, 39.712],
            [140.584024, 39.811778],
            [140.550063, 39.89456],
            [140.383871, 40.028791],
            [140.317394, 40.034494],
            [140.218809, 39.878296],
            [140.243392, 39.811778],
            [140.350633, 39.70604],
            [140.52297, 39.712],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 6.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [142.976471, 34.522927],
            [142.444655, 34.595768],
            [141.347786, 34.911581],
            [140.882448, 35.014967],
            [140.417109, 35.006787],
            [140.084725, 34.910599],
            [139.985009, 34.858842],
            [139.685863, 34.823312],
            [139.386717, 34.906315],
            [139.071398, 35.188741],
            [139.06722, 35.321778],
            [139.353479, 35.485695],
            [139.453194, 35.597179],
            [139.468429, 35.65437],
            [139.437347, 35.787407],
            [139.37801, 35.887185],
            [139.169414, 36.12],
            [139.042863, 36.219778],
            [139.002623, 36.352815],
            [139.12081, 36.468336],
            [139.287002, 36.480736],
            [139.424129, 36.452593],
            [139.55291, 36.548797],
            [139.597113, 36.751926],
            [139.77966, 36.984741],
            [139.817077, 37.084519],
            [139.798174, 37.383852],
            [139.74426, 37.516889],
            [139.920947, 37.816222],
            [139.937693, 37.916],
            [140.062401, 38.148815],
            [140.070345, 38.248593],
            [139.985009, 38.462953],
            [139.985009, 38.56021],
            [139.951324, 38.614444],
            [139.852007, 38.647704],
            [139.765195, 38.747481],
            [139.727789, 38.814],
            [139.716691, 38.913778],
            [139.790642, 39.046815],
            [139.918533, 39.142791],
            [140.018248, 39.139739],
            [140.045306, 39.113333],
            [140.09202, 38.947037],
            [140.18444, 38.84383],
            [140.460086, 38.980296],
            [140.49983, 39.080074],
            [140.503586, 39.213111],
            [140.48101, 39.24637],
            [140.383871, 39.278055],
            [140.291868, 39.412667],
            [140.350633, 39.549734],
            [140.483586, 39.568941],
            [140.550063, 39.486411],
            [140.683017, 39.445883],
            [140.749494, 39.459099],
            [140.815971, 39.526171],
            [140.841, 39.645481],
            [140.792068, 39.845037],
            [140.80018, 39.911556],
            [140.860654, 40.077852],
            [140.939592, 40.17763],
            [140.817854, 40.476963],
            [140.843152, 40.61],
            [141.015402, 40.789505],
            [141.248071, 40.916448],
            [141.414263, 40.964258],
            [141.695393, 41.175407],
            [142.178748, 41.268697],
            [142.710563, 41.29248],
            [144.27277, 41.234332],
            [144.871063, 41.145299],
            [145.239768, 41.009111],
            [145.469355, 40.881472],
            [145.690054, 40.709778],
            [145.868216, 40.514721],
            [146.016311, 40.277407],
            [146.100748, 40.044593],
            [146.13837, 39.778519],
            [146.100133, 39.512444],
            [144.688351, 35.587852],
            [144.553897, 35.321778],
            [144.27277, 34.999568],
            [143.873909, 34.735615],
            [143.508286, 34.599734],
            [142.976471, 34.522927],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 6.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.109424, 34.885153],
            [142.943232, 34.868587],
            [142.544371, 34.928726],
            [141.314548, 35.2979],
            [140.948925, 35.383483],
            [140.683017, 35.383186],
            [140.350633, 35.237359],
            [139.985009, 35.172741],
            [139.885294, 35.230602],
            [139.707153, 35.421556],
            [139.641902, 35.554593],
            [139.619386, 35.75171],
            [139.434111, 36.053481],
            [139.420228, 36.12],
            [139.294487, 36.253037],
            [139.299962, 36.286296],
            [139.386717, 36.345676],
            [139.55291, 36.35257],
            [139.619386, 36.394037],
            [139.6829, 36.485852],
            [139.737002, 36.718667],
            [139.865425, 36.918222],
            [139.938115, 37.117778],
            [139.951315, 37.250815],
            [139.918533, 37.525339],
            [139.952462, 37.583407],
            [140.101153, 37.683185],
            [140.229306, 37.882741],
            [140.350633, 37.986468],
            [140.383871, 38.064759],
            [140.405539, 38.182074],
            [140.324086, 38.448148],
            [140.340255, 38.547926],
            [140.419071, 38.680963],
            [140.717468, 38.947037],
            [140.997411, 39.412667],
            [141.160722, 39.578963],
            [141.162439, 39.678741],
            [141.104781, 39.778519],
            [141.043252, 39.811778],
            [141.04864, 39.891215],
            [141.148355, 39.948209],
            [141.314548, 39.85371],
            [141.347786, 39.806649],
            [141.447502, 39.839876],
            [141.513978, 39.833763],
            [141.66213, 39.911556],
            [141.847904, 40.277407],
            [141.852028, 40.410444],
            [141.79724, 40.61],
            [141.879602, 40.756227],
            [141.979317, 40.816705],
            [142.178748, 40.86412],
            [142.943232, 40.929737],
            [144.206293, 40.895128],
            [144.70487, 40.826785],
            [145.004016, 40.716555],
            [145.170209, 40.624126],
            [145.469355, 40.358842],
            [145.601128, 40.14437],
            [145.663673, 39.978074],
            [145.691761, 39.778519],
            [145.65638, 39.545704],
            [144.904301, 37.479661],
            [144.28666, 35.68763],
            [144.203134, 35.521333],
            [144.05585, 35.321778],
            [143.807432, 35.11294],
            [143.475047, 34.95728],
            [143.109424, 34.885153],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.042948, 35.188411],
            [142.943232, 35.179946],
            [142.644086, 35.226629],
            [140.815971, 35.834881],
            [140.550063, 35.859573],
            [140.250917, 35.81277],
            [140.117963, 35.856867],
            [139.951771, 35.969018],
            [139.852056, 36.004946],
            [139.776788, 36.186519],
            [139.802147, 36.419333],
            [139.893366, 36.785185],
            [140.058657, 37.151037],
            [140.040578, 37.317333],
            [140.060738, 37.417111],
            [140.12863, 37.516889],
            [140.305008, 37.649926],
            [140.488602, 37.849481],
            [140.592092, 38.281852],
            [140.632097, 38.647704],
            [140.739214, 38.814],
            [140.990135, 39.080074],
            [141.04864, 39.231685],
            [141.181594, 39.280866],
            [141.414202, 39.046815],
            [141.48074, 39.030298],
            [141.646932, 39.069947],
            [141.946078, 39.350927],
            [142.023561, 39.512444],
            [142.034556, 39.612222],
            [141.909689, 39.911556],
            [141.914279, 40.044593],
            [142.079032, 40.275452],
            [142.278463, 40.45696],
            [142.544371, 40.547308],
            [143.175901, 40.606046],
            [144.173055, 40.588495],
            [144.571917, 40.534758],
            [144.904301, 40.389814],
            [145.136848, 40.17763],
            [145.269802, 39.911556],
            [145.286888, 39.778519],
            [145.268221, 39.612222],
            [143.873909, 35.676396],
            [143.740955, 35.495802],
            [143.568604, 35.355037],
            [143.342094, 35.245452],
            [143.042948, 35.188411],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.142663, 35.479221],
            [142.976471, 35.456489],
            [142.743801, 35.488472],
            [141.148355, 36.054676],
            [140.948925, 36.096773],
            [140.583302, 36.092761],
            [140.510897, 36.153259],
            [140.450348, 36.271385],
            [140.418697, 36.286296],
            [140.354496, 36.452593],
            [140.360465, 36.519111],
            [140.649779, 36.770306],
            [140.733787, 36.984741],
            [140.892874, 37.184296],
            [140.935011, 37.317333],
            [140.874552, 37.583407],
            [140.873582, 37.716444],
            [140.751232, 37.916],
            [140.693413, 38.082296],
            [140.808331, 38.614444],
            [140.863389, 38.714222],
            [141.015402, 38.867145],
            [141.115117, 38.895341],
            [141.248071, 38.817963],
            [141.347786, 38.640142],
            [141.447502, 38.62662],
            [141.563834, 38.780741],
            [141.83655, 38.980296],
            [142.201888, 39.379407],
            [142.271589, 39.545704],
            [142.285627, 39.944815],
            [142.379596, 40.077852],
            [142.544371, 40.186928],
            [142.810278, 40.256492],
            [143.508286, 40.319721],
            [144.139817, 40.316372],
            [144.50544, 40.258719],
            [144.672962, 40.17763],
            [144.871317, 39.978074],
            [144.919115, 39.845037],
            [144.905051, 39.612222],
            [144.239532, 37.760105],
            [143.600712, 35.853926],
            [143.422822, 35.621111],
            [143.33103, 35.554593],
            [143.142663, 35.479221],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.383871, 37.112449],
            [140.284156, 37.114907],
            [140.208322, 37.217556],
            [140.215459, 37.317333],
            [140.284156, 37.390975],
            [140.417109, 37.398796],
            [140.504185, 37.284074],
            [140.465711, 37.184296],
            [140.383871, 37.112449],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 7.5 },
        geometry: {
          type: "LineString",
          coordinates: [
            [140.18444, 36.441507],
            [139.989383, 36.55237],
            [139.97774, 36.618889],
            [140.018248, 36.721327],
            [140.151202, 36.739761],
            [140.219139, 36.685407],
            [140.241341, 36.55237],
            [140.293799, 36.485852],
            [140.18444, 36.441507],
          ],
        },
      },
      {
        type: "Feature",
        properties: { value: 8.0 },
        geometry: {
          type: "LineString",
          coordinates: [
            [143.076186, 35.740926],
            [142.843517, 35.740875],
            [142.710563, 35.783601],
            [142.295063, 35.953704],
            [142.050327, 36.086741],
            [141.920726, 36.219778],
            [141.893046, 36.286296],
            [141.90991, 36.419333],
            [142.295323, 37.217556],
            [142.592237, 37.982519],
            [142.926363, 39.013556],
            [143.079055, 39.712],
            [143.122369, 39.811778],
            [143.255732, 39.944815],
            [143.475047, 39.995193],
            [144.139817, 40.053684],
            [144.372486, 40.01373],
            [144.540613, 39.878296],
            [144.578776, 39.778519],
            [144.566268, 39.645481],
            [143.886624, 37.749704],
            [143.313961, 35.986963],
            [143.228629, 35.853926],
            [143.076186, 35.740926],
          ],
        },
      },
    ],
  });
  await sdb.done();
});
